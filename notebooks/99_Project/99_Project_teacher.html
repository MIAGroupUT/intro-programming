

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Project &#8212; Manual Introduction to Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://utwente.mia.nl/template/notebooks/99_Project/99_Project_teacher.html" />
    <link rel="shortcut icon" href="https://www.utwente.nl/.utdesign/img/favicons/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/banner.jpeg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/banner.jpeg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../frontmatter/preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_GettingStarted/1_GettingStarted_student.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Scripts/2_Scripts_student.html">2. Control structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Functions/3_Functions_student.html">3. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Objects/3_Objects_student.html">4. Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_ModulesPackages/4_ModulesPackages_student.html">5. Modules and packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Files/4_Files_student.html">6. Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_NumPy/5_NumPy_student.html">7. NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_Visualization/6_Visualization_student.html">8. Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_DataAnalysis/7_DataAnalysis_student.html">9. Data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="99_Project_student.html">10. Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../backmatter/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backmatter/resources.html">Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyter.utwente.nl/hub/user-redirect/git-pull?repo=https%3A//github.com/MIAGroupUT/intro-programming&urlpath=lab/tree/intro-programming/jupyter-book/notebooks/99_Project/99_Project_teacher.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/MIAGroupUT/intro-programming/blob/main/jupyter-book/notebooks/99_Project/99_Project_teacher.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MIAGroupUT/intro-programming" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MIAGroupUT/intro-programming/issues/new?title=Issue%20on%20page%20%2Fnotebooks/99_Project/99_Project_teacher.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/99_Project/99_Project_teacher.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inleiding">Inleiding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opdrachten">Opdrachten</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-3">Opdracht 3:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-4">Opdracht 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-5">Opdracht 5:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-6">Opdracht 6:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-7">Opdracht 7:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-8">Opdracht 8:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-9">Opdracht 9:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-10">Opdracht 10:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-11">Opdracht 11:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#referenties">Referenties</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="project">
<h1>Project<a class="headerlink" href="#project" title="Permalink to this heading">#</a></h1>
<p>In dit hoofdstuk werk je met behulp van Python een casus uit met echte patiëntendata. Gebruik hierbij de functies en modules die je eerder in de cursus bent tegengekomen.</p>
<section id="inleiding">
<h2>Inleiding<a class="headerlink" href="#inleiding" title="Permalink to this heading">#</a></h2>
<p>Voor patiënten met type 1 of 2 diabetes is het belangrijk dat de bloedglucose goed gereguleerd is want dat beperkt de kans op ontwikkeling van macro- en microvasculaire complicaties. Er zijn meerdere manieren om de bloedglucose te monitoren:</p>
<ul class="simple">
<li><p><strong>HbA1c:</strong> Dat is een maat voor de hoeveelheid glucose dat zich in de afgelopen 3 maanden heeft opgestapeld in de rode bloedcellen. (Dit is niet hetzelfde als glucoseconcentratie in het bloed.)</p></li>
<li><p><strong>Bloedglucosemonitoring (BGM):</strong> Diabeten die insuline gebruiken prikken dagelijks 4 a 6 keer: bij ontbijt, lunch, diner en soms bij de 2 tussendoortjes op een dag, en voor het slapen gaan. Daarnaast prikken ze ook wanneer er symptomen zijn van een hypo- of hyperglycemie. Met die prikken wordt bloedglucose gemeten.</p></li>
<li><p>Tegenwoordig gebruiken steeds meer diabeten een <strong>continue glucosemeter (CGM)</strong>, die, afhankelijk van het type, iedere 5 of 15 minuten een glucosemeting doet.</p></li>
</ul>
<p>Met de komst van de CGM hebben diabeten en hun behandelaren meer inzicht gekregen in de glucoseregulatie. Er zijn op basis daarvan nieuwe klinische CGM-parameters gedefinieerd (zie Tabel 1 en Figuur 1) en de verwachting is dat we daarmee de belangrijke maar moeilijker te bepalen HbA1c kunnen schatten.
Voor deze opdracht maken we gebruik van open-source data van een studie<span class="math notranslate nohighlight">\(^{1}\)</span> die onderzoekt of CGM zonder regelmatige vingerprik net zo veilig is als het gebruik van CGM met regelmatige vingerprik. Dit onderzoek is gedaan bij Type 1 diabetespatiënten. De CGM die de patiënten gebruiken tijdens dit onderzoek bepaalt iedere 5 minuten een glucosewaarde.</p>
<p><strong>Tabel 1</strong> Gebruikte variabelen en hun eenheid, doel en omschrijving.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p>Afkorting</p></th>
<th class="head text-left"><p>Naam</p></th>
<th class="head text-left"><p>Definitie</p></th>
<th class="head text-left"><p>Doel</p></th>
<th class="head text-left"><p>Eenheid</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(g_{BGM}\)</span></p></td>
<td class="text-left"><p>BGM</p></td>
<td class="text-left"><p>bloedglucosemonitoring</p></td>
<td class="text-left"><p>glucoseconcentratie (op onregelmatige tijden)</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>mmol/L</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(g_{CGM}\)</span></p></td>
<td class="text-left"><p>CGM</p></td>
<td class="text-left"><p>continueglucosemonitoring</p></td>
<td class="text-left"><p>glucoseconcentratie (gemaakt door een continue glucosemeter)</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>mmol/L</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(h\)</span></p></td>
<td class="text-left"><p>HBA1c</p></td>
<td class="text-left"><p><em>hemoglobinA1c</em></p></td>
<td class="text-left"><p>hoeveelheid glucose in bloedcel</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>mmol/L</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(h_{CGM}\)</span></p></td>
<td class="text-left"><p>eA1</p></td>
<td class="text-left"><p><em>extimated HbA1c</em></p></td>
<td class="text-left"><p>schatting van HbA1c op basis van gemiddelde CGM</p></td>
<td class="text-left"><p>&lt; 53</p></td>
<td class="text-left"><p>mmol/L</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>12.71 mmol/mol</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(b\)</span></p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>4.70587 L/mol</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(p_{TAR}\)</span></p></td>
<td class="text-left"><p>TAR</p></td>
<td class="text-left"><p><em>time above range</em></p></td>
<td class="text-left"><p>percentage van de tijd dat de CGM boven 10 mmol/L is</p></td>
<td class="text-left"><p>&lt; 30</p></td>
<td class="text-left"><p>%</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(p_{TIR}\)</span></p></td>
<td class="text-left"><p>TIR</p></td>
<td class="text-left"><p><em>time in range</em></p></td>
<td class="text-left"><p>percentage van de tijd dat de CGM tussen 3.9 en 10 mmol/L is</p></td>
<td class="text-left"><p>&gt; 70</p></td>
<td class="text-left"><p>%</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(p_{TBR}\)</span></p></td>
<td class="text-left"><p>TBR</p></td>
<td class="text-left"><p><em>time below range</em></p></td>
<td class="text-left"><p>percentage van de tijd dat de CGM onder 3.9 mmol/L is</p></td>
<td class="text-left"><p>&lt; 5</p></td>
<td class="text-left"><p>%</p></td>
</tr>
</tbody>
</table>
<p><img alt="My Image" src="https://surfdrive.surf.nl/files/index.php/s/qFua4yqda63motN/download" /><br />
<strong>Figuur 1</strong> Voorbeeld van een gestapelde staafdiagram van CGM-waarden (mmol/L) met hun doelen. Zo is in het ideale geval de TIR (percentage van de tijd dat 3.9 &lt;CGM&lt; 10) meer dan 70%. Zie ook tabel 1.</p>
</section>
<section id="opdrachten">
<h2>Opdrachten<a class="headerlink" href="#opdrachten" title="Permalink to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Opdracht 1</p>
<p>De gegevens zijn opgeslagen in het bestand <code class="docutils literal notranslate"><span class="pre">glucosedata.mat</span></code> dat je op Canvas kunt vinden. Om MATLAB of <code class="docutils literal notranslate"><span class="pre">.mat</span></code> bestanden in Python te openen kun je de <code class="docutils literal notranslate"><span class="pre">loadmat</span></code> functie van de <code class="docutils literal notranslate"><span class="pre">scipy.io</span></code> module gebruiken. Om de <code class="docutils literal notranslate"><span class="pre">scipy.io</span></code> module te kunnen gebruiken, moet je eerst <code class="docutils literal notranslate"><span class="pre">scipy</span></code> installeren via de volgende code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">scipy</span>
</pre></div>
</div>
<p>Zoek zelf in de documentatie van SciPy op hoe de <code class="docutils literal notranslate"><span class="pre">loadmat</span></code> functie werkt. Zoals je ziet geeft deze functie een dictionary terug met daarin als key de naam van een variabele en als value de waarde daarvan. Schrijf in onderstaande cell code op de variabele <code class="docutils literal notranslate"><span class="pre">glucodat</span></code> te lezen.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="c1"># Laden van het bestand glucosedata.mat met functie loadmat</span>
<span class="n">mat_contents</span> <span class="o">=</span> 

<span class="c1"># Laad de variabele glucodat</span>
<span class="n">glucodat</span> <span class="o">=</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;/var/folders/07/x0gf6dj176dfjvrn357t5p6h0000gn/T/ipykernel_53135/2457528420.py&quot;</span><span class="gt">, line </span><span class="mi">6</span>
    <span class="n">mat_contents</span> <span class="o">=</span>
                   <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="c1"># Laden van het bestand glucosedata.mat met functie loadmat</span>
<span class="n">mat_contents</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;C:/Users/veerl/Documents/Inleiding Programmeren/tm-introduction-programming/data/glucosedata.mat&#39;</span><span class="p">)</span>

<span class="c1"># De variabele glucodat </span>
<span class="n">glucodat</span> <span class="o">=</span> <span class="n">mat_contents</span><span class="p">[</span><span class="s1">&#39;glucodat&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">~/opt/anaconda3/envs/notebook_collaboration/lib/python3.7/site-packages/scipy/io/matlab/mio.py</span> in <span class="ni">_open_file</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">39</span>         <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_like</span><span class="p">,</span> <span class="n">mode</span><span class="p">),</span> <span class="kc">True</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;C:/Users/veerl/Documents/Inleiding Programmeren/tm-introduction-programming/data/glucosedata.mat&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">1909997843.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># Laden van het bestand glucosedata.mat met functie loadmat</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">mat_contents</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;C:/Users/veerl/Documents/Inleiding Programmeren/tm-introduction-programming/data/glucosedata.mat&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> 
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># De variabele glucodat</span>

<span class="nn">~/opt/anaconda3/envs/notebook_collaboration/lib/python3.7/site-packages/scipy/io/matlab/mio.py</span> in <span class="ni">loadmat</span><span class="nt">(file_name, mdict, appendmat, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span><span class="s2">     variable_names = kwargs.pop(&#39;variable_names&#39;, None)</span>
<span class="ne">--&gt; </span><span class="mi">224</span><span class="s2">     with _open_file_context(file_name, appendmat) as f:</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span><span class="s2">         MR, _ = mat_reader_factory(f, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span><span class="s2">         matfile_dict = MR.get_variables(variable_names)</span>

<span class="nn">~/opt/anaconda3/envs/notebook_collaboration/lib/python3.7/contextlib.py</span> in <span class="ni">__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span><span class="s2">         del self.args, self.kwds, self.func</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span><span class="s2">         try:</span>
<span class="ne">--&gt; </span><span class="mi">112</span><span class="s2">             return next(self.gen)</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span><span class="s2">         except StopIteration:</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span><span class="s2">             raise RuntimeError(&quot;generator didn&#39;t yield&quot;) from None</span>

<span class="nn">~/opt/anaconda3/envs/notebook_collaboration/lib/python3.7/site-packages/scipy/io/matlab/mio.py</span> in <span class="ni">_open_file_context</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span><span class="s2"> @contextmanager</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span><span class="s2"> def _open_file_context(file_like, appendmat, mode=&#39;rb&#39;):</span>
<span class="ne">---&gt; </span><span class="mi">17</span><span class="s2">     f, opened = _open_file(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span><span class="s2">     try:</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span><span class="s2">         yield f</span>

<span class="nn">~/opt/anaconda3/envs/notebook_collaboration/lib/python3.7/site-packages/scipy/io/matlab/mio.py</span> in <span class="ni">_open_file</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span><span class="s2">             if appendmat and not file_like.endswith(&#39;.mat&#39;):</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span><span class="s2">                 file_like += &#39;.mat&#39;</span>
<span class="ne">---&gt; </span><span class="mi">45</span><span class="s2">             return open(file_like, mode), True</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span><span class="s2">         else:</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span><span class="s2">             raise IOError(</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;C:/Users/veerl/Documents/Inleiding Programmeren/tm-introduction-programming/data/glucosedata.mat&#39;
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Opdracht 2 </p>
<p>Achterhaal wat voor type de variabele <code class="docutils literal notranslate"><span class="pre">glucodat</span></code> is. Hiervoor kun je de <code class="docutils literal notranslate"><span class="pre">type</span></code> functie gebruiken die je eerder hebt geleerd.
Als het goed is zie je dat <code class="docutils literal notranslate"><span class="pre">glucodat</span></code> een NumPy structured array is met meerdere fields.  Zo te zien is “ID_293” de ID van de laatste patiënt. Bepaal in onderstaande cell code hoeveel patiënten er in totaal zijn?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Type van de variabele glucodat</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">glucodat</span><span class="p">))</span> 

<span class="c1"># Displaying the fields of glucodat</span>
<span class="n">IDs</span> <span class="o">=</span> <span class="n">glucodat</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>

<span class="c1"># Het aantal patiënten is gelijk aan het aantal velden (fields) in glucodat</span>
<span class="n">aantal_patienten</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">IDs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Het totaal aantal patiënten is: </span><span class="si">{</span><span class="n">aantal_patienten</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># In totaal 131 patiënten</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">286901398.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Type van de variabele glucodat</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">glucodat</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Displaying the fields of glucodat</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">IDs</span> <span class="o">=</span> <span class="n">glucodat</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>

<span class="ne">NameError</span>: name &#39;glucodat&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Iedere patiënt heeft een unieke ID. Voor elke patiënt zijn metingen van BGM en CGM en HbA1c opgeslagen. Voor de laatste patiënt is dat:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>.time</p></th>
<th class="head text-center"><p>.data</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>glucodat.ID_293.BGM.time</p></td>
<td class="text-center"><p>glucodat.ID_293.BGM.data</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>glucodat.ID_293.CGM.time</p></td>
<td class="text-center"><p>glucodat.ID_293.CGM.data</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>glucodat.ID_293.HbA1c.time</p></td>
<td class="text-center"><p>glucodat.ID_293.HbA1c.data</p></td>
</tr>
</tbody>
</table>
<p>Hier is <strong>time</strong> een vector van tijden, en <strong>data</strong> de bijbehorende meetwaarden. De BGM is vaak gemeten op onregelmatige tijden; de CGM zijn de continue glucosemetingen, meestal regelmatig gemeten. Van de HbA1c is per patiënt maar één meting uitgevoerd, maar de waarde is twee keer opgeslagen. Dat maakt het plotten ervan makkelijk:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">patient_id</span> <span class="o">=</span> <span class="s1">&#39;ID_293&#39;</span>
<span class="n">time_component</span><span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data_component</span><span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_component</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data_component</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>De tijd is in dagen, de glucosedata (BGM, CGM) is in mmol/L, en de HbA1c is in
mmol/mol. Per patiënt is er 3 maanden aan data geselecteerd. Patiënten hebben verschillende hoeveelheden BGM- en CGM-metingen gedaan. Daardoor is de
data van iedere patiënt verschillend van lengte.
Met een for-loop kun je door de patiënten lopen om, vervolgens, per patiënt
de data te gebruiken:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verkrijg een lijst van patient IDs</span>
<span class="n">IDs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">IDs</span><span class="p">)</span>

<span class="c1"># Loop door de ID lijst één voor één</span>
<span class="k">for</span> <span class="n">patient_id</span> <span class="ow">in</span> <span class="n">IDs</span><span class="p">:</span>
    <span class="c1"># Hiermee kan je de data van de ... </span>
    <span class="n">CGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Doe iet met CGM       # ... CGM bereiken, en eriets mee doen</span>
</pre></div>
</div>
<section id="opdracht-3">
<h3>Opdracht 3:<a class="headerlink" href="#opdracht-3" title="Permalink to this heading">#</a></h3>
<p>Importeer <code class="docutils literal notranslate"><span class="pre">random</span></code> en gebruik de functie <code class="docutils literal notranslate"><span class="pre">random.sample()</span></code> om drie willekeurige patiënten te selecteren. Maak vervolgens in één figuur drie subplots (voor elke patiënt een subplot), en zet per patiënt in één subplot:</p>
<ol class="arabic simple">
<li><p>de CGM van de patiënt als functie van tijd,</p></li>
<li><p>de BGM van de patiënt als functie van tijd (gebruik stem in plaats van plot om het verschil met CGM beter te zien),</p></li>
<li><p>de gemiddelde bloedglucoseconcentratie g (mmol/L) van de patiënt geschat a.d.h.v. opgestapelde glucose in bloedcellen <span class="math notranslate nohighlight">\(h\)</span> = HbA1c als
<br>
<span class="math notranslate nohighlight">\(g = \frac{h − a}{b}\)</span>
<br>
met <span class="math notranslate nohighlight">\(a\)</span> = 12.71mmol/mol en <span class="math notranslate nohighlight">\(b\)</span> = 4.70587L/mol.</p></li>
</ol>
<p>Voeg zinvolle titels, labels en legenda toe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Definieer de parameters voor de schatting van de gemiddelde bloedglucoseconcentratie</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">12.71</span>  <span class="c1"># mmol/mol</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">4.70587</span>  <span class="c1"># L/mol</span>

<span class="c1"># Kies drie willekeurige patiënten</span>
<span class="n">selected_patients</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">IDs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Loop door de geselecteerde patiënten</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">patient_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Haal de CGM, BGM en HbA1c data op voor de huidige patiënt</span>
    <span class="n">CGM_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">CGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">BGM_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;BGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">BGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;BGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">HbA1c_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">HbA1c_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Plot alle waarden van de huidige patiënt in één subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># Plot de CGM van de patiënt als functie van tijd</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CGM_time</span><span class="p">,</span> <span class="n">CGM_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot de BGM van de patiënt als functie van tijd (gebruik stem)</span>
    <span class="c1">#plt.stem(bgm_time, bgm_data, label=&#39;BGM&#39;,linefmt =&#39;pink&#39;,markerfmt =&#39;D&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BGM_time</span><span class="p">,</span> <span class="n">BGM_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Bereken de geschatte gemiddelde bloedglucoseconcentratie g</span>
    <span class="n">g_estimate</span> <span class="o">=</span> <span class="n">HbA1c_data</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

    <span class="c1"># Plot de geschatte gemiddelde bloedglucoseconcentratie</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">HbA1c_time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gemiddelde glucoseconcentratie&#39;</span><span class="p">)</span>

    <span class="c1"># Zet labels en titel</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Patient </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">patient_id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tijd(dagen)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentratie (mmol/L)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">1232127747.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># Kies drie willekeurige patiënten</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">selected_patients</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">IDs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> 
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="c1"># Loop door de geselecteerde patiënten</span>

<span class="ne">NameError</span>: name &#39;IDs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="opdracht-4">
<h3>Opdracht 4<a class="headerlink" href="#opdracht-4" title="Permalink to this heading">#</a></h3>
<p>Wat valt je op aan de verschillende plots? Zijn er verschillen tussen patiënten?</p>
<p>Jouw antwoord</p>
<ul class="simple">
<li><p>Beschrijf verschil tussen de geschatte gemiddelde glucose concentratie en CGM en BGM: de De gemiddelde glucoseconcentratie geschat aan de hand van de opgestapelde glucose in de rode bloedcellen is significant hoger dan gemeten met CGM en BGM.</p></li>
<li><p>Beschrijf verschillen tussen CGM en BGM. De CGM toont meer uitschieters dan de BGM. BGM heeft ook minder meetpunten dat CGM.</p></li>
<li><p>Beschrijf verschillen tussen de patiënten. Bijvoorbeeld de verschillen tussen de lengte van de data.</p></li>
</ul>
<p><strong>HbA1c vs klinische CGM parameters:</strong> Nu gaan we HbA1c vergelijken met een paar klinische CGM-parameters. We onderscheiden vier parameters (per patiënt):</p>
<ul class="simple">
<li><p><em><strong>eA1c</strong></em> In opdracht 3 schatten we een gemiddelde glucoseconcentratie <span class="math notranslate nohighlight">\(g\)</span> uit <span class="math notranslate nohighlight">\(h\)</span> = HbA1c volgens de formule <span class="math notranslate nohighlight">\(g = \frac{h − a}{b}\)</span>. Omgekeerd kunnen we uit het gemiddelde <span class="math notranslate nohighlight">\(g_{cgm}\)</span> van de CGM-metingen van de patiënt de  <span class="math notranslate nohighlight">\(h\)</span> = HbA1c schatten volgens <br>
<br>
<span class="math notranslate nohighlight">\(h_{CGM} = a +b\overline{g}_{cgm}\)</span>       (mmol/mol)
<br>
<br>
met <span class="math notranslate nohighlight">\(a\)</span> = 12.71 mmol/mol en <span class="math notranslate nohighlight">\(b\)</span> = 4.70587L/mol. Deze hCGM wordt eA1c genoemd (voor “estimated HbA1c”).</p></li>
<li><p><em><strong>TAR</strong></em>: Dit is het percentage samples van CGM hoger dan 10.0 mmol/L.</p></li>
<li><p><em><strong>TIR</strong></em>: Dit het percentage samples van CGM tussen de 3.9 en 10.0 mmol/L.</p></li>
<li><p><em><strong>TBR</strong></em>: Dit is het percentage samples van CGM kleiner dan 3.9 mmol/L.</p></li>
</ul>
</section>
<section id="opdracht-5">
<h3>Opdracht 5:<a class="headerlink" href="#opdracht-5" title="Permalink to this heading">#</a></h3>
<p>Maak een Python functie <em>Gluc_param</em> die voor een gegeven CGM signaal (van een patiënt) alle 4 parameters (eA1c, TAR, TIR, TBR) bepaalt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Gluc_param</span><span class="p">(</span><span class="n">CGM_signaal</span><span class="p">):</span>
    <span class="c1"># Constants voor de eA1c berekening</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">12.71</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mf">4.70587</span>

    <span class="c1"># Bereken eA1c</span>
    <span class="n">eA1c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">CGM_signaal</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Bereken TAR, TIR, TBR percentages # KLOPT DIT OF MOET HET DELEN DOOR HET TOTAAL AANTAL SIGNALEN ZIJN</span>
    <span class="n">tar_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">CGM_signaal</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">tir_percentage</span> <span class="o">=</span> <span class="p">((</span><span class="n">CGM_signaal</span> <span class="o">&gt;=</span> <span class="mf">3.9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">CGM_signaal</span> <span class="o">&lt;=</span> <span class="mf">10.0</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">tbr_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">CGM_signaal</span> <span class="o">&lt;</span> <span class="mf">3.9</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="k">return</span> <span class="n">eA1c</span><span class="p">,</span> <span class="n">tar_percentage</span><span class="p">,</span> <span class="n">tir_percentage</span><span class="p">,</span> <span class="n">tbr_percentage</span>

<span class="c1"># Voorbeeldgebruik:</span>
<span class="c1"># Selecteer 1 patiënt</span>
<span class="n">select_ID</span><span class="o">=</span><span class="s1">&#39;ID_293&#39;</span>
<span class="n">CGM_signaal</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">select_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Roep de functie aan</span>
<span class="n">eA1c</span><span class="p">,</span> <span class="n">tar</span><span class="p">,</span> <span class="n">tir</span><span class="p">,</span> <span class="n">tbr</span> <span class="o">=</span> <span class="n">Gluc_param</span><span class="p">(</span><span class="n">CGM_signaal</span><span class="p">)</span>

<span class="c1"># Toon de resultaten</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eA1c: </span><span class="si">{</span><span class="n">eA1c</span><span class="si">}</span><span class="s2"> mmol/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TAR: </span><span class="si">{</span><span class="n">tar</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TIR: </span><span class="si">{</span><span class="n">tir</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TBR: </span><span class="si">{</span><span class="n">tbr</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">1308286635.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="c1"># Selecteer 1 patiënt</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="n">select_ID</span><span class="o">=</span><span class="s1">&#39;ID_293&#39;</span>
<span class="ne">---&gt; </span><span class="mi">19</span> <span class="n">CGM_signaal</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">select_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> 
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="c1"># Roep de functie aan</span>

<span class="ne">NameError</span>: name &#39;glucodat&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>De streefwaarde van HbA1c voor diabetespatiënten is &lt; 53 mmol/mol. Voor de sommige patiënten is deze streefwaarde lastig te behalen. Nu willen we kijken hoe de verschillende HbA1c streefwaarden zich verhouden tot de CGM-parameters (eA1c, TAR, TIR, TBR). We onderscheiden drie groepen:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Patiëntgroep 1:</p></td>
<td class="text-center"><p>laag: HbA1c ≤ 53</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Patiëntgroep 2:</p></td>
<td class="text-center"><p>midden: 53 &lt; HbA1c &lt; 63</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>patiëntgroep 3:</p></td>
<td class="text-center"><p>hoog: HbA1c ≥ 63</p></td>
</tr>
</tbody>
</table>
</section>
<section id="opdracht-6">
<h3>Opdracht 6:<a class="headerlink" href="#opdracht-6" title="Permalink to this heading">#</a></h3>
<p>Maak een <em>stacked bar chart</em>, waarbij de drie verschillende patiëntgroepen naast elkaar op de x-as staan, en, per patiëntgroep de gemiddelde TBR, TIR en TAR voor de patiëntgroep op elkaar gestapeld staan, een beetje zoals in Figuur 1.
<br>
Hints: (i) Gebruik een for-loop om deze klinische parameters te bepalen
voor alle patiënten en opslaan in één vector/matrix. (ii) Gebruik dezelfde for-loop om een vector met verschillende nummers voor de verschillende groepen te creeëren. (iii) Bereken de gemiddelde TBR, TIR en TAR, voor de verschillende groepen. (iv.) Maak een bar-graph met de functie <strong>bar</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1: Sla alle klinische parametrs op in één matrix</span>
<span class="n">Gluc_parameters</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">IDs</span><span class="p">)))</span>
<span class="n">patient_groep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">IDs</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">patient_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">IDs</span><span class="p">):</span>
    <span class="c1"># Hiermee kan je de data van de ... </span>
    <span class="n">CGM_signaal</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">eA1c</span><span class="p">,</span> <span class="n">tar</span><span class="p">,</span> <span class="n">tir</span><span class="p">,</span> <span class="n">tbr</span> <span class="o">=</span> <span class="n">Gluc_param</span><span class="p">(</span><span class="n">CGM_signaal</span><span class="p">)</span>
    <span class="c1"># Sla de parameters op in de matrix</span>
    <span class="n">Gluc_parameters</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">eA1c</span><span class="p">,</span> <span class="n">tar</span><span class="p">,</span> <span class="n">tir</span><span class="p">,</span> <span class="n">tbr</span><span class="p">]</span>

<span class="c1"># 2: Maak een vector met verschillende nummers voor de verschillende groepen</span>
<span class="c1"># Onderverdeel in patiëntgroepen op basis van eA1c</span>
<span class="n">patient_groepen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Gluc_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;=</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Gluc_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># Let op dat </span>
<span class="c1">#je de middelste groep niet definieërd maar wel op plek 1 in de matrix zet!!</span>

<span class="c1"># 3: Bereken de gemiddelde TBR, TIR en TAr voor de verschillende groepen</span>
<span class="c1"># Lijsten voor het opslaan van gemiddelde waarden per groep</span>
<span class="c1"># bepaal de posities dat patient_groepen is gelijk aan groep 0</span>
<span class="c1"># Lijst met posities van elke patiëntgroep</span>
<span class="n">posities_groepen</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">patient_groepen</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

<span class="c1"># Bereken gemiddelde waarden per groep</span>
<span class="n">gemiddelde_tar</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Gluc_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">posities</span><span class="p">])</span> <span class="k">for</span> <span class="n">posities</span> <span class="ow">in</span> <span class="n">posities_groepen</span><span class="p">]</span>
<span class="n">gemiddelde_tir</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Gluc_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">posities</span><span class="p">])</span> <span class="k">for</span> <span class="n">posities</span> <span class="ow">in</span> <span class="n">posities_groepen</span><span class="p">]</span>
<span class="n">gemiddelde_tbr</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Gluc_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">posities</span><span class="p">])</span> <span class="k">for</span> <span class="n">posities</span> <span class="ow">in</span> <span class="n">posities_groepen</span><span class="p">]</span>

<span class="c1"># Toon de resultaten</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gemiddelde TBR, TIR en TAR per patiëntgroep:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Patiëntgroep 0 (Laag):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TBR: </span><span class="si">{</span><span class="n">gemiddelde_tbr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, TIR: </span><span class="si">{</span><span class="n">gemiddelde_tir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, TAR: </span><span class="si">{</span><span class="n">gemiddelde_tar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Patiëntgroep 1 (Midden):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TBR: </span><span class="si">{</span><span class="n">gemiddelde_tbr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, TIR: </span><span class="si">{</span><span class="n">gemiddelde_tir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, TAR: </span><span class="si">{</span><span class="n">gemiddelde_tar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Patiëntgroep 2 (Hoog):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TBR: </span><span class="si">{</span><span class="n">gemiddelde_tbr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">, TIR: </span><span class="si">{</span><span class="n">gemiddelde_tir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">, TAR: </span><span class="si">{</span><span class="n">gemiddelde_tar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 4: Maak een bar-graph</span>

<span class="c1"># Patiëntgroepnamen</span>
<span class="n">groepen</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Laag&#39;</span><span class="p">,</span> <span class="s1">&#39;Midden&#39;</span><span class="p">,</span> <span class="s1">&#39;Hoog&#39;</span><span class="p">]</span>

<span class="c1"># Breedte van de bars</span>
<span class="n">bar_breedte</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="c1"># Positie op de x-as voor elke groep</span>
<span class="n">posities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groepen</span><span class="p">))</span>

<span class="c1"># Maak de stacked bar chart</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bar_tbr</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">posities</span> <span class="o">-</span> <span class="n">bar_breedte</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">gemiddelde_tbr</span><span class="p">,</span> <span class="n">bar_breedte</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TBR&#39;</span><span class="p">)</span>
<span class="n">bar_tir</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">posities</span> <span class="o">-</span> <span class="n">bar_breedte</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">gemiddelde_tir</span><span class="p">,</span> <span class="n">bar_breedte</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TIR&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">gemiddelde_tbr</span><span class="p">)</span>
<span class="n">bar_tar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">posities</span> <span class="o">-</span> <span class="n">bar_breedte</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">gemiddelde_tar</span><span class="p">,</span> <span class="n">bar_breedte</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TAR&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gemiddelde_tbr</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gemiddelde_tir</span><span class="p">))</span>

<span class="c1"># Voeg labels, titels en legenda toe</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Patiëntgroepen&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gemiddelde TBR, TIR en TAR per patiëntgroep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">posities</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">groepen</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Toon de plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">1040279718.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># 1: Sla alle klinische parametrs op in één matrix</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">Gluc_parameters</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">IDs</span><span class="p">)))</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">patient_groep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">IDs</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">patient_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">IDs</span><span class="p">):</span>

<span class="ne">NameError</span>: name &#39;IDs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="opdracht-7">
<h3>Opdracht 7:<a class="headerlink" href="#opdracht-7" title="Permalink to this heading">#</a></h3>
<p>Wat valt op aan de resultaten? Welke groepen behalen de CGM parameterdoelen (zoals beschreven in Figuur 1).</p>
<p>Jouw uitleg</p>
<p>Een aantal zaken vallen op:</p>
<ul class="simple">
<li><p>De groep TIR is percentueel het hoogste in de Lage en hoge groep. In de ‘Midden’ groep is TAR percentueel het hoogst.</p></li>
<li><p>Geen enkele groep behaald alle doelen. De groep ‘Laag’ wijkt wel het minste af. Alleen de TBR is hier 0.2% te hoog.</p></li>
<li><p>Alleen de groep ‘Laag’ behaald een TIR &gt; 70%.</p></li>
<li><p>Opvallend dat de groep ‘Midden’ een hoger percentage TAR heeft dan de groep ‘Hoog’.</p></li>
</ul>
<p><strong>Moving average:</strong> Het is je wellicht opgevallen dat de CGM-metingen als functie van tijd enorm fluctueren. Door de metingen te middelen over tijd ontstaat er een langzaam variërende functie van tijd, en die zegt vermoedelijk meer over HbA1c. Het langzaam variërende signaal construeren we met een “moving averaging” filter van orde <span class="math notranslate nohighlight">\(M\)</span>. Dat is een filter dat op basis van metingen <span class="math notranslate nohighlight">\(x_{1},x_{1},...,x_{n}\)</span> het signaal <span class="math notranslate nohighlight">\(y_{1},y_{1},...,y_{n}\)</span> bepaalt volgens de regel
<br>
<br>
<span class="math notranslate nohighlight">\(y_{k}=\frac{1}{M+1}(x_{k},x_{k-1},...,x_{k-M}),   k=1,..,n\)</span><br />
<br>
<br> Het getal <span class="math notranslate nohighlight">\(M\)</span> wordt de “orde” van het filter genoemd.</p>
</section>
<section id="opdracht-8">
<h3>Opdracht 8:<a class="headerlink" href="#opdracht-8" title="Permalink to this heading">#</a></h3>
<p>Maak een Python functie movingav.m met syntax y=movingav(x,M) die uit een vector <span class="math notranslate nohighlight">\(x\)</span> een vector <span class="math notranslate nohighlight">\(y\)</span> bepaalt zoals gedefinieerd in (1). [Hint: Gebruik <code class="docutils literal notranslate"><span class="pre">np.convolve()</span></code> in mode=<code class="docutils literal notranslate"><span class="pre">same</span></code>]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">movingav</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    x: input vector</span>
<span class="sd">    M: orde van het filter</span>

<span class="sd">    Returns:</span>
<span class="sd">    y: output vector na toepassing van moving average filter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Controleer of de orde M geldig is</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Orde M moet een niet-negatief geheel getal zijn.&#39;</span><span class="p">)</span>

    <span class="c1"># Bepaal de coëfficiënten van het moving average filter</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Pas het filter toe op de inputvector x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="opdracht-9">
<h3>Opdracht 9:<a class="headerlink" href="#opdracht-9" title="Permalink to this heading">#</a></h3>
<p>Controleer deze functie met onderstaande code, en leg uit waarom de plot klopt.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">movingav</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1"># ook wel &quot;lollipop plot&quot; genoemd</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code... + uitleg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Controle code</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">movingav</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1"># ook wel &quot;lollipop plot&quot; genoemd</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.33333333 0.66666667 1.         1.         1.         0.66666667]
</pre></div>
</div>
<img alt="../../_images/48cec3fe88d35eafde3bd601c373dad85c7003ed88d254b324b31883d2641781.png" src="../../_images/48cec3fe88d35eafde3bd601c373dad85c7003ed88d254b324b31883d2641781.png" />
</div>
</div>
<p>Het filter heeft een windowsize van M + 1 oftewel 2 + 1 = 3. Het filter start in t=0 oftewel x=0 en omvat, met een windowsize van 3, de waarde x=0 en x=1. Om een output y van dezelfde lengte als input x te generen wordt een extra 0 toegevoegd. De berekening is nu als volgt: 1/3*(0 + 0 + 1) =  1/3. Vervolgens verschuift het filter 1 positie en wordt de volgende berekening uitgevoerd: 1/3*(0 + 1 +1) = 2/3. Etc.</p>
</section>
<section id="opdracht-10">
<h3>Opdracht 10:<a class="headerlink" href="#opdracht-10" title="Permalink to this heading">#</a></h3>
<p>Selecteer drie patiënten, en, per patiënt, maak een figuur met daarin een plot van de:</p>
<ul class="simple">
<li><p>ongefilterde CGM data,</p></li>
<li><p>gefilterde CGM data (dus bepaald m.b.v. movingav)</p></li>
<li><p>de geschatte gemiddelde bloedglucoseconcentratie <span class="math notranslate nohighlight">\(g\)</span> bepaald op basis van de HbA1c gegevens (zoals in opdracht 3(3))</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Kies drie willekeurige patiënten</span>
<span class="n">selected_patients</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">IDs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Bepaal filter orde</span>
<span class="n">M</span><span class="o">=</span><span class="mi">2</span>

<span class="c1"># Loop door de geselecteerde patiënten</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">patient_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Haal de CGM, BGM en HbA1c data op voor de huidige patiënt</span>
    <span class="n">CGM_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">CGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    
    <span class="n">flattened_cgm_data</span> <span class="o">=</span> <span class="n">CGM_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">CGM_filt</span> <span class="o">=</span> <span class="n">movingav</span><span class="p">(</span><span class="n">flattened_cgm_data</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">HbA1c_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">HbA1c_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Plot alle waarden van de huidige patiënt in één subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_patients</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># Plot de CGM van de patiënt als functie van tijd</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CGM_time</span><span class="p">,</span> <span class="n">CGM_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot de BGM van de patiënt als functie van tijd (gebruik stem)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CGM_time</span><span class="p">,</span> <span class="n">CGM_filt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gefilterd CGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Bereken de geschatte gemiddelde bloedglucoseconcentratie g</span>
    <span class="n">g_estimate</span> <span class="o">=</span> <span class="n">HbA1c_data</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

    <span class="c1"># Plot de geschatte gemiddelde bloedglucoseconcentratie</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">HbA1c_time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gemiddelde glucoseconcentratie&#39;</span><span class="p">)</span>

    <span class="c1"># Zet labels en titel</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Patient </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">patient_id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tijd(dagen)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentratie (mmol/L)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">3595474949.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Kies drie willekeurige patiënten</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">selected_patients</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">IDs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Bepaal filter orde</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">M</span><span class="o">=</span><span class="mi">2</span>

<span class="ne">NameError</span>: name &#39;IDs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="opdracht-11">
<h3>Opdracht 11:<a class="headerlink" href="#opdracht-11" title="Permalink to this heading">#</a></h3>
<p>Maak plaatjes met verschillende orde <span class="math notranslate nohighlight">\(M\)</span> van het moving average filter. Filter bijvoorbeeld ook eens met grote orders, bijvoorbeeld het aantal samples voor een dag, of voor een week. Je mag er vanuit gaan dat de samplefrequentie 5/min is. Wat valt je op voor verschillende filter ordes?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code... + uitleg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecteer één willekeurige patiënt </span>
<span class="n">patient_id</span><span class="o">=</span><span class="s1">&#39;ID_293&#39;</span>

<span class="c1"># Gebruik meerdere ordes</span>
<span class="n">dag_samp</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># (uren*minuten*1/samp_freq)</span>
<span class="n">week_samp</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># (dagen*uren*minuten*1/samp_freq)</span>
<span class="n">M_select</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="n">dag_samp</span><span class="p">,</span><span class="n">week_samp</span><span class="p">])</span>

<span class="c1"># Loop door de geselecteerde patiënten</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_select</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">M_select</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Haal de CGM, BGM en HbA1c data op voor de huidige patiënt</span>
    <span class="n">CGM_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">CGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    
    <span class="n">flattened_cgm_data</span> <span class="o">=</span> <span class="n">CGM_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">CGM_filt</span> <span class="o">=</span> <span class="n">movingav</span><span class="p">(</span><span class="n">flattened_cgm_data</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">HbA1c_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">HbA1c_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;HbA1c&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Plot alle waarden van de huidige patiënt in één subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M_select</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># Plot de CGM van de patiënt als functie van tijd</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CGM_time</span><span class="p">,</span> <span class="n">CGM_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot de BGM van de patiënt als functie van tijd (gebruik stem)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CGM_time</span><span class="p">,</span> <span class="n">CGM_filt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gefilterd CGM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Bereken de geschatte gemiddelde bloedglucoseconcentratie g</span>
    <span class="n">g_estimate</span> <span class="o">=</span> <span class="n">HbA1c_data</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

    <span class="c1"># Plot de geschatte gemiddelde bloedglucoseconcentratie</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">HbA1c_time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gemiddelde glucoseconcentratie&#39;</span><span class="p">)</span>

    <span class="c1"># Zet labels en titel</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Patient </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">patient_id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tijd(dagen)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentratie (mmol/L)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="n">x0gf6dj176dfjvrn357t5p6h0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53135</span><span class="o">/</span><span class="mf">3234937313.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">M_select</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="c1"># Haal de CGM, BGM en HbA1c data op voor de huidige patiënt</span>
<span class="ne">---&gt; </span><span class="mi">14</span>     <span class="n">CGM_time</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">CGM_data</span> <span class="o">=</span> <span class="n">glucodat</span><span class="p">[</span><span class="n">patient_id</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CGM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> 

<span class="ne">NameError</span>: name &#39;glucodat&#39; is not defined
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1500x1500 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<p>Door een grotere orde (M) van het movingaverage filter wordt het sterk flunctuerende CGM signaal meer gemiddeld en dus vlakker.</p>
</section>
</section>
<section id="referenties">
<h2>Referenties<a class="headerlink" href="#referenties" title="Permalink to this heading">#</a></h2>
<p><strong>[1]</strong>: <em>Aleppo G, Ruedy KJ, Riddlesworth TD, Kruger DF, Peters AL, Hirsch I, et al. REPLACE-BG: A Randomized Trial Comparing Continuous Glucose Monitoring With and Without Routine Blood Glucose Monitoring in Adults With Well-Controlled Type 1 Diabetes. Diabetes Care [Internet]. 2017 Apr 1 [cited 2021 Oct 4];40(4):538–45. Available from: <a class="reference external" href="https://care.diabetesjournals.org/content/40/4/538">https://care.diabetesjournals.org/content/40/4/538</a>. Dataset beschikbaar vanaf: <a class="reference external" href="https://public.jaeb.org/datasets/diabetes">https://public.jaeb.org/datasets/diabetes</a>.</em></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/99_Project"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inleiding">Inleiding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opdrachten">Opdrachten</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-3">Opdracht 3:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-4">Opdracht 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-5">Opdracht 5:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-6">Opdracht 6:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-7">Opdracht 7:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-8">Opdracht 8:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-9">Opdracht 9:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-10">Opdracht 10:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opdracht-11">Opdracht 11:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#referenties">Referenties</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jelmer Wolterink
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>